import tkinter as tk
import random

#project plan: tower defense (but like the only defense is the player)

#tower in center of window
    #hp bar

#player
    #attack - by running into enemies? 

#enemies
    #waves?
    #movement
    #attack
    #hp 
    #difficulty scaling
        #multiple types?
        #increase stats
            #dmg, hp, speed

# Constants
WIDTH = 800
HEIGHT = WIDTH*4//5

ENEMY_SIZE = 25 #they'll just be squares

# Functions
def tower_sprite(): # 50x75 p0x
    pattern = [
        "01110000001110000001110000001110000001110000001110",
        "11111000011111000011111000011111000011111000011111",
        "11111000011111000011111000011111000011111000011111",
        "11111000011111000011111000011111000011111000011111",
        "11111000011111000011111000011111000011111000011111",
        "11111000011111000011111000011111000011111000011111",
        "11111000011111000011111000011111000011111000011111",
        "11111000011111000011111000011111000011111000011111",
        "11111000011111000011111000011111000011111000011111",
        "11111100111111100111111100111111100111111100111111",
        "11111111111111111111111111111111111111111111111111",
        "11111111111111111111111111111111111111111111111111",
        "01111111111111111111111111111111111111111111111110",
        "00111111111211111111211111111211111111211111111100",
        "00011111112121111112121111112121111112121111111000",
        "00001111121112111121112111121112111121112111110000",
        "00001111121112111121112111121112111121112111110000",
        "00000111211111211211111211211111211211111211100000",
        "00000111211111211211111211211111211211111211100000",
        "00000011111111111111111111111111111111111111000000",
        "00000011111111111111111111111111111111111111000000",
        "00000011111111111111111111111111111111111111000000",
        "00000011111111111111111111111111111111111111000000",
        "00000011111111111111111111111111111111111111000000",
        "00000111111111111111111111111111111111111111100000",
        "00000111111111111111111111111111111111111111100000",
        "00000111111111122222211111111222222111111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00000111111111222222221111112222222211111111100000",
        "00001111111111222222221111112222222211111111110000",
        "00001111111111111111111111111111111111111111110000",
        "00001111111111111111111111111111111111111111110000",
        "00001111111111111111111111111111111111111111110000",
        "00001111111111111111111111111111111111111111110000",
        "00001111111111111111111111111111111111111111110000",
        "00001111111111111111111111111111111111111111110000",
        "00001111111111111111111222211111111111111111110000",
        "00001111111111111111112222221111111111111111110000",
        "00001111111122211111112222221111111222111111110000",
        "00001111111222221111112222221111112222211111110000",
        "00011111111222221111112222221111112222211111111000",
        "00011111111222221111112222221111112222211111111000",
        "00011111111222221111112222221111112222211111111000",
        "00011111111222221111112222221111112222211111111000",
        "00011111111222221111111111111111112222211111111000",
        "00011111111111111111111111111111111111111111111000",
        "00011111111111111111111111111111111111111111111000",
        "00011111111111111111111111111111111111111111111000",
        "00011111111111111111111111111111111111111111111000",
        "00111111111111111111111111111111111111111111111100",
        "00111111111111111111111111111111111111111111111100",
        "00111122211111111111111111111111111111111222111100",
        "00111222221111111111112222221111111111112222211100",
        "00111222221111111111122222222111111111112222211100",
        "00111222221111111111222222222211111111112222211100",
        "00111222221111111111222222222211111111112222211100",
        "00111222221111111111222222222211111111112222211100",
        "01111222221111111111222222222211111111112222211110",
        "01111111111111111111222222222211111111111111111110",
        "01111111111111111111222222222211111111111111111110",
        "01111111111111111111222222222211111111111111111110",
        "01111111111111111111211222211211111111111111111110",
        "01111111111111111111222222222211111111111111111110",
        "11111111111111111111222222222211111111111111111111",
        "11111111111111111111222222222211111111111111111111",
        "11111111111111111111222222222211111111111111111111",
        "11111111111111111111222222222211111111111111111111",
    ]

    h = len(pattern)
    w = len(pattern[0])

    img = tk.PhotoImage(width=w, height=h)

    for y in range(h):
        for x in range(w):
            if pattern[y][x] == "1":
                img.put("#856337", (x,y))
            elif pattern[y][x] == "2":
                img.put("#D19754", (x,y))
    
    return img

def player_sprite(dir="right"): # 25x25 p0x
    if dir == "right":
        pattern = [
            "0000000000111110000000000",
            "0000000001111111000030000",
            "0000000011111111100333000",
            "0000000011121121103333300",
            "0000000011121121103333300",
            "0000000011111111103333300",
            "0000000011211121103333300",
            "0000330001122211003030300",
            "0333333330111110000030000",
            "0333333330001000000030000",
            "0333333330221220000030000",
            "0333333332112112200030000",
            "0333333331111111210030000",
            "0333333331111111211030000",
            "0333333331111111011222000",
            "0333333331111111001222000",
            "0033333301222221000222000",
            "0033333302111112000030000",
            "0003333001111111000030000",
            "0000330001110111000030000",
            "0000000001110111000030000",
            "0000000001110111000030000",
            "0000000222120212220030000",
            "0000002222220222222030000",
            "0000002222220222222000000",
        ]
    elif dir == "left":
        pattern = [
            "0000000000111110000000000",
            "0000300001111111000000000",
            "0003330011111111100000000",
            "0033333011211211100000000",
            "0033333011211211100000000",
            "0033333011111111100000000",
            "0033333011211121100000000",
            "0030303001122211000330000",
            "0000300000111110333333330",
            "0000300000001000333333330",
            "0000300000221220333333330",
            "0000300022112112333333330",
            "0000300121111111333333330",
            "0000301121111111333333330",
            "0002221101111111333333330",
            "0002221001111111333333330",
            "0002220001222221033333300",
            "0000300002111112033333300",
            "0000300001111111003333000",
            "0000300001110111000330000",
            "0000300001110111000000000",
            "0000300001110111000000000",
            "0000300222120212220000000",
            "0000302222220222222000000",
            "0000002222220222222000000",
        ]

    h = len(pattern)
    w = len(pattern[0])

    img = tk.PhotoImage(width=w, height=h)

    for y in range(h):
        for x in range(w):
            if pattern[y][x] == "1":
                img.put("#1E114E", (x,y))
            elif pattern[y][x] == "2":
                img.put("#1DE4D3", (x,y))
            elif pattern[y][x] == "3":
                img.put("#747474", (x,y))
    
    return img

def enemy_sprite(): # 25x25 p0x
    pattern = [
        "0000000000000000000000000",
        "0000000001111111000000000",
        "0000000011111111100000000",
        "0000000111111111110000000",
        "0000001111111111111000000",
        "0000001111111111111000000",
        "0000011111111111111100000",
        "0000011111111111111100000",
        "0000111111111111111110000",
        "0020111111111111111110200",
        "0222211111111111111122220",
        "2222222211111111122222222",
        "0022222222211122222222200",
        "0000122222222222222210000",
        "0000111122222222211110000",
        "0001011111122211111101000",
        "0001011111111111111101000",
        "0001001111122211111001000",
        "0001000111211121110001000",
        "0001000112111112110001000",
        "0001010111111111110101000",
        "0000110110111110110110000",
        "0000000110011100110000000",
        "0000000110000000110000000",
        "0000001110000000111000000",
    ]

    h = len(pattern)
    w = len(pattern[0])

    img = tk.PhotoImage(width=w, height=h)

    for y in range(h):
        for x in range(w):
            if pattern[y][x] == "1":
                img.put("#250303", (x,y))
            elif pattern[y][x] == "2":
                img.put("#D81212", (x,y))
    
    return img

def move_right(event):
    global player, player_img
    canvas.move(player, p_spd, 0)
    player_img = player_sprite("right")
    x, y = canvas.coords(player)
    canvas.delete(player)
    player = canvas.create_image(x, y, image=player_img, anchor="center")

def move_left(event):
    global player_img, player
    canvas.move(player, -p_spd, 0)
    player_img = player_sprite("left")
    x, y = canvas.coords(player)
    canvas.delete(player)
    player = canvas.create_image(x, y, image=player_img, anchor="center")

def move_up(event):
    canvas.move(player, 0, -p_spd)

def move_down(event):
    canvas.move(player, 0, p_spd)

def add_enemy_wave(num):
    for n in range(num):
        pass
        #make enemy -> add to enemies list ///////////////TODO

def move_enemies():
    pass

def collision(obj_a, obj_b):
    ax1, ay1, ax2, ay2 = canvas.bbox(obj_a)
    bx1, by1, bx2, by2 = canvas.bbox(obj_b)

def start():
    pass

def gameloop():
    pass

# Other Code/ Initial values

enemies = []
p_spd = 15
p_dmg = 5
t_hp = 500
e_spd = 15
e_dmg = 5
e_hp = 5

root = tk.Tk()
root.title("Tower Defense Game")

canvas = tk.Canvas(root, width=WIDTH, height=HEIGHT, bg="#0B5A00")
canvas.pack()

tower_img = tower_sprite()
player_img = player_sprite()
enemy_img = enemy_sprite()

tower = canvas.create_image(WIDTH//2, HEIGHT//2, image=tower_img, anchor="center")
player = canvas.create_image(WIDTH//2, HEIGHT*3//5, image=player_img, anchor="center")

root.bind("w", move_up)
root.bind("a", move_left)
root.bind("s", move_down)
root.bind("d", move_right)

root.mainloop()